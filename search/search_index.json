{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Gitea Multi-Cloud Disaster Recovery Infrastructure","text":""},{"location":"#resumen-ejecutivo","title":"Resumen Ejecutivo","text":"<p>Este proyecto implementa una arquitectura multi-nube de alta disponibilidad para Gitea (servicio Git self-hosted) con capacidades de disaster recovery mediante replicaci\u00f3n MySQL entre AWS y Azure. La soluci\u00f3n demuestra pr\u00e1cticas modernas de DevOps, Infrastructure as Code (IaC), CI/CD automatizado, y estrategias de failover cross-cloud con notificaci\u00f3n y activaci\u00f3n manual.</p> <p>Caracter\u00edsticas Principales:</p> <ul> <li>Infraestructura como C\u00f3digo (Terraform) en AWS y Azure</li> <li>Gesti\u00f3n de Configuraci\u00f3n automatizada (Ansible)</li> <li>Replicaci\u00f3n MySQL unidireccional (AWS \u2192 Azure) con lag &lt; 1 segundo</li> <li>T\u00fanel VPN Site-to-Site IPsec entre clouds</li> <li>Servidores Jenkins independientes por cloud</li> <li>Failover manual con notificaci\u00f3n autom\u00e1tica</li> <li>RTO objetivo: ~20 minutos | RPO objetivo: &lt; 1 segundo</li> </ul>"},{"location":"#arquitectura-de-la-solucion-multi-cloud","title":"Arquitectura de la Soluci\u00f3n Multi-Cloud","text":"<p>La soluci\u00f3n se compone de 4 repositorios Git independientes que trabajan de forma coordinada:</p> Repositorio Cloud Tipo Prop\u00f3sito tf-infra-demoGitea AWS Terraform IaC Provisiona infraestructura AWS (Primary) ansible-demoGitea AWS Ansible Config Despliega/configura Gitea en AWS EC2 tf-az-infra-demoGitea Azure Terraform IaC Provisiona infraestructura Azure (DR) ansible-az-demoGitea Azure Ansible Config Despliega/configura Gitea en Azure VM <p>Diagrama de arquitectura completa:</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                         GITEA MULTI-CLOUD ARCHITECTURE                              \u2502\n\u2502                     High Availability with Database Replication                     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502       AWS (Primary Site)         \u2502         \u2502     Azure (Failover Site)        \u2502\n\u2502      Region: us-east-1           \u2502         \u2502      Region: East US             \u2502\n\u2502      VPC: 10.0.0.0/16            \u2502         \u2502      VNet: 10.1.0.0/16           \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n               \u2502                                          \u2502\n               \u2502                                          \u2502\n\u250f\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u25bc\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513         \u250f\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u25bc\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n\u2503  [1] TERRAFORM (AWS)      \u2503         \u2503  [3] TERRAFORM (Azure)    \u2503\n\u2503  tf-infra-demoGitea       \u2503\u25c4\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2503  tf-az-infra-demoGitea    \u2503\n\u2503                           \u2503  VPN    \u2503                           \u2503\n\u2503  Creates:                 \u2503 Gateway \u2503  Creates:                 \u2503\n\u2503  \u2022 VPC + Subnets          \u2503  IPsec  \u2503  \u2022 VNet + Subnets         \u2503\n\u2503  \u2022 EC2 (t3.small)         \u2503 Tunnel  \u2503  \u2022 VM Gitea (Standard_DC1ds_v3)   \u2503\n\u2503  \u2022 RDS MySQL (Master)     \u2503\u25c4\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba\u2503  \u2022 VM MySQL (Replica)   \u2503\n\u2503  \u2022 Application LB         \u2503         \u2503  \u2022 Load Balancer          \u2503\n\u2503  \u2022 Security Groups        \u2503         \u2503  \u2022 Network Security Group \u2503\n\u2503  \u2022 VPN Gateway            \u2503         \u2503  \u2022 VPN Gateway            \u2503\n\u2503                           \u2503         \u2503                           \u2503\n\u2503  Outputs:                 \u2503         \u2503  Outputs:                 \u2503\n\u2503  \u2713 ec2_public_ip          \u2503         \u2503  \u2713 vm_public_ip           \u2503\n\u2503  \u2713 rds_endpoint           \u2503         \u2503  \u2713 mysql_server_host      \u2503\n\u2503  \u2713 alb_dns_name           \u2503         \u2503  \u2713 lb_public_ip           \u2503\n\u2503  \u2713 vpn_tunnel_ip          \u2503         \u2503  \u2713 vpn_gateway_ip         \u2503\n\u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252f\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251b         \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252f\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251b\n               \u2502                                          \u2502\n               \u2502 Outputs feed Ansible                     \u2502 Outputs feed Ansible\n               \u2502                                          \u2502\n\u250f\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u25bc\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513         \u250f\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u25bc\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n\u2503  [2] ANSIBLE (AWS)        \u2503         \u2503  [4] ANSIBLE (Azure)      \u2503\n\u2503  ansible-demoGitea        \u2503         \u2503  ansible-az-demoGitea     \u2503\n\u2503                           \u2503         \u2503                           \u2503\n\u2503  Configures:              \u2503         \u2503  Configures:              \u2503\n\u2503  \u2022 Install Gitea binary   \u2503         \u2503  \u2022 Install Gitea binary   \u2503\n\u2503  \u2022 Configure app.ini      \u2503         \u2503  \u2022 Configure app.ini      \u2503\n\u2503  \u2022 MySQL connection       \u2503         \u2503  \u2022 MySQL connection       \u2503\n\u2503  \u2022 Systemd service        \u2503         \u2503  \u2022 Systemd service        \u2503\n\u2503  \u2022 User/permissions       \u2503         \u2503  \u2022 User/permissions       \u2503\n\u2503                           \u2503         \u2503                           \u2503\n\u2503  Inventory:               \u2503         \u2503  Inventory:               \u2503\n\u2503  \u2022 Dynamic (from TF)      \u2503         \u2503  \u2022 Static                 \u2503\n\u2503  \u2022 Host: infraGitea       \u2503         \u2503  \u2022 Host: azureGitea       \u2503\n\u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252f\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251b         \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252f\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251b\n               \u2502                                          \u2502\n               \u2502 Deploys                                  \u2502 Deploys\n               \u25bc                                          \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   [APP] Gitea Application (AWS)  \u2502         \u2502   [APP] Gitea Application (Azure)\u2502\n\u2502                                  \u2502         \u2502                                  \u2502\n\u2502   EC2: 54.123.45.67             \u2502         \u2502   VM: 20.98.76.54               \u2502\n\u2502   Port: 3000 \u2192 ALB \u2192 80         \u2502         \u2502   Port: 3000 \u2192 LB \u2192 80          \u2502\n\u2502   Status: [ACTIVE] (Primary)     \u2502         \u2502   Status: [STANDBY] (Failover)   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n               \u2502                                          \u2502\n               \u2502 Writes                                   \u2502 Reads (Replica)\n               \u25bc                                          \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   [DB] RDS MySQL (Master)        \u2502         \u2502   [DB] VM MySQL  (Replica)       \u2502\n\u2502   mydb.abc.rds.amazonaws.com     \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25b6   mysql-gitea.mysql.azure.com   \u2502\n\u2502   Port: 3306                     \u2502 Binlog  \u2502   Port: 3306                     \u2502\n\u2502   Status: [PRIMARY]              \u2502 Repl    \u2502   Status: [REPLICATING]          \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"#decisiones-de-arquitectura-clave","title":"Decisiones de Arquitectura Clave","text":""},{"location":"#dos-servidores-jenkins-independientes","title":"Dos Servidores Jenkins Independientes","text":"<p>Contexto: Cada cloud provider requiere credenciales, configuraciones y pol\u00edticas de acceso espec\u00edficas.</p> <p>Decisi\u00f3n: Desplegar un servidor Jenkins dedicado en cada cloud (Jenkins AWS + Jenkins Azure) en lugar de un \u00fanico Jenkins centralizado.</p> <p>Justificaci\u00f3n:</p> <ul> <li>[\u2713] Aislamiento de credenciales: Cada Jenkins solo tiene acceso a su cloud</li> <li>[\u2713] Autonom\u00eda operativa: Azure puede operar independientemente si AWS falla</li> <li>[\u2713] Seguridad: Reducci\u00f3n de superficie de ataque (no hay credenciales cross-cloud en un solo lugar)</li> </ul>"},{"location":"#ssh-jump-host-bastion-en-azure","title":"SSH Jump Host (Bastion) en Azure","text":"<p>Contexto: Seguridad de la base de datos MySQL.</p> <p>MySQL VM sin IP p\u00fablica, accesible solo v\u00eda SSH ProxyJump a trav\u00e9s de Gitea VM.</p> <ul> <li>[\u2713] Seguridad: MySQL no expuesto a Internet</li> <li>[\u2713] Costo: No se consume IP p\u00fablica adicional</li> <li>[\u2713] Compliance: Mejor postura de seguridad para auditor\u00edas</li> <li>[\u2713] Complejidad: Ansible requiere configuraci\u00f3n ProxyCommand</li> </ul> <p>Arquitectura de acceso:</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                 Azure VNet (10.1.0.0/16)                     \u2502\n\u2502                                                              \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502  Gitea VM           \u2502         \u2502  MySQL VM          \u2502   \u2502\n\u2502   \u2502  (Jump Host)        \u2502         \u2502  (Private only)    \u2502   \u2502\n\u2502   \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524         \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524   \u2502\n\u2502   \u2502                     \u2502         \u2502                    \u2502   \u2502\n\u2502   \u2502 Public IP:          \u2502         \u2502 Public IP: NONE    \u2502   \u2502\n\u2502   \u2502   40.71.214.30      \u2502         \u2502                    \u2502   \u2502\n\u2502   \u2502                     \u2502         \u2502 Private IP:        \u2502   \u2502\n\u2502   \u2502 Private IP:         \u2502         \u2502   10.1.1.4         \u2502   \u2502\n\u2502   \u2502   10.1.0.5          \u2502         \u2502                    \u2502   \u2502\n\u2502   \u2502                     \u2502         \u2502 Port 22: \u2713 (SSH)  \u2502   \u2502\n\u2502   \u2502 Port 22: \u2713 (SSH)   \u2502         \u2502 Port 3306: \u2713       \u2502   \u2502\n\u2502   \u2502 Port 3000: \u2713 (HTTP)\u2502         \u2502                    \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25b2\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502             \u2502                               \u2502              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n              \u2502                               \u2502\n              \u2502  Internet                     \u2502  Internal\n              \u2502  Access                       \u2502  Routing Only\n              \u2502                               \u2502\n     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510           \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n     \u2502  Developer/     \u2502           \u2502  Jump Connection   \u2502\n     \u2502  Jenkins        \u2502           \u2502  (ProxyCommand)    \u2502\n     \u2502                 \u2502           \u2502                    \u2502\n     \u2502  ssh azureuser@ \u2502           \u2502  ssh -J azureuser@ \u2502\n     \u2502    40.71.214.30 \u2502           \u2502    40.71.214.30    \u2502\n     \u2502                 \u2502           \u2502    azureuser@      \u2502\n     \u2502                 \u2502           \u2502    10.1.1.4        \u2502\n     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518           \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n        Direct SSH                     ProxyJump SSH\n</code></pre>"},{"location":"#replicacion-mysql-unidireccional-aws-azure","title":"Replicaci\u00f3n MySQL Unidireccional (AWS \u2192 Azure)","text":"<p>Contexto: Definir flujo de datos entre clouds.</p> <p>Decisi\u00f3n: Replicaci\u00f3n master-slave unidireccional de AWS (Master) hacia Azure (Replica).</p> <p>Justificaci\u00f3n:</p> <ul> <li>[\u2713] Simplicidad: Evita conflictos de sincronizaci\u00f3n bidireccional</li> <li>[\u2713] Rol claro: AWS es PRIMARY, Azure es DR</li> <li>[\u2713] Prevenci\u00f3n split-brain: No hay escrituras simult\u00e1neas en ambos clouds</li> </ul> <p>Flujo de replicaci\u00f3n:</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                     DATABASE REPLICATION                       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\nAWS RDS MySQL (Master)\n      \u2502\n      \u2502 [Step 1] User operation (INSERT/UPDATE/DELETE)\n      \u2502\n      \u251c\u2500\u2500\u2192 Write to binlog (mysql-bin.000001)\n      \u2502    Format: ROW (row-based replication)\n      \u2502\n      \u2502 [Step 2] Binlog transmission\n      \u2502\n      \u251c\u2500\u2500\u2192 Through VPN IPsec Tunnel\n      \u2502    (10.0.0.0/16 \u2194 10.1.0.0/16)\n      \u2502    Port: 3306 (encrypted)\n      \u2502\n      \u25bc\nAzure MV MySQL  (Replica)\n      \u2502\n      \u2502 [Step 3] Replica IO Thread\n      \u2502\n      \u251c\u2500\u2500\u2192 Receive binlog events\n      \u2502    Store in relay-log\n      \u2502\n      \u2502 [Step 4] Replica SQL Thread\n      \u2502\n      \u251c\u2500\u2500\u2192 Apply SQL statements\n      \u2502    Update Seconds_Behind_Master\n      \u2502\n      \u25bc\n[REPLICATION ACTIVE]\nLag: &lt; 1 second\n</code></pre>"},{"location":"#flujo-operacional-normal","title":"Flujo Operacional Normal","text":""},{"location":"#aws-activo-azure-standby","title":"AWS Activo + Azure Standby","text":"<p>Durante operaciones normales, la arquitectura opera en modo h\u00edbrido cost-optimized:</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502       AWS (PRODUCCI\u00d3N)      \u2502     \u2502   Azure (DB ONLY - Standby) \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524     \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                             \u2502     \u2502                             \u2502\n\u2502  [\u2713] Users \u2192 ALB \u2192 EC2      \u2502     \u2502  [X] NO VM                  \u2502\n\u2502                  \u2193          \u2502     \u2502  [X] NO Load Balancer       \u2502\n\u2502           RDS MySQL \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2192 [\u2713] MySQL Replica        \u2502\n\u2502           (Master)          \u2502 VPN \u2502     (Replicating)           \u2502\n\u2502                             \u2502     \u2502                             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                                 \u25b2\n                                                 \u2502\n                                          Continuous MySQL\n                                           Replication\n                                           (&lt; 1 sec lag)\n</code></pre>"},{"location":"#flujo-de-datos-usuario-aplicacion-base-de-datos","title":"Flujo de Datos: Usuario \u2192 Aplicaci\u00f3n \u2192 Base de Datos","text":"<p>Arquitectura de capas en AWS:</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                     USER REQUEST FLOW                          \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n[1] User (Developer)\n      \u2502\n      \u2502 HTTP Request: http://gitea-alb-123.us-east-1.elb.amazonaws.com\n      \u2502 Action: git clone, web UI navigation, API call\n      \u2502\n      \u25bc\n[2] Application Load Balancer (ALB)\n      \u2502\n      \u2502 Target Group: EC2 instances on port 3000\n      \u2502 Health Check: /api/healthz (every 30s)\n      \u2502 Listener: HTTP:80 \u2192 HTTP:3000\n      \u2502\n      \u25bc\n[3] EC2 Instance (Gitea Application)\n      \u2502\n      \u2502 Gitea Binary: /usr/local/bin/gitea\n      \u2502 Config: /etc/gitea/app.ini\n      \u2502 Service: systemd (gitea.service)\n      \u2502 User: git\n      \u2502\n      \u251c\u2500 [3a] Read operations (SELECT)\n      \u2502   \u2514\u2500\u2192 Fast response from RDS read replica\n      \u2502\n      \u251c\u2500 [3b] Write operations (INSERT/UPDATE/DELETE)\n      \u2502   \u2514\u2500\u2192 Write to RDS Master\n      \u2502        \u2514\u2500\u2192 Binlog generated\n      \u2502             \u2514\u2500\u2192 Replicated to Azure\n      \u2502\n      \u25bc\n[4] RDS MySQL Master\n      \u2502\n      \u2502 Database: gitea_db\n      \u2502 Tables: user, repository, issue, pull_request, etc.\n      \u2502 Binlog: mysql-bin.000001 (ROW format)\n      \u2502\n      \u2514\u2500\u2192 [5] MySQL Replication\n            \u2502\n            \u2502 VPN Tunnel (10.0.0.0/16 \u2192 10.1.0.0/16)\n            \u2502 Port: 3306 (encrypted via IPsec)\n            \u2502 User: repl_azure@10.1.%\n            \u2502\n            \u25bc\n          Azure MySQL Flexible Server (Replica)\n            \u2502\n            \u2514\u2500 Replica lag: &lt; 1 second\n            \u2514\u2500 Data ready for failover\n</code></pre>"},{"location":"#despliegue-con-jenkins-aws","title":"Despliegue con Jenkins:  AWS","text":"<p>Flujo del pipeline:</p> <pre><code>[Trigger] Jenkins Build (Manual or Git webhook)\n    \u2193\n[Stage 1: Terraform Apply]\n    \u251c\u2500 terraform init (initialize providers)\n    \u251c\u2500 terraform plan (preview changes)\n    \u251c\u2500 terraform apply -auto-approve (create resources)\n    \u2502   \u251c\u2500 VPC + Subnets\n    \u2502   \u251c\u2500 EC2 Instance (stopped initially)\n    \u2502   \u251c\u2500 RDS MySQL\n    \u2502   \u251c\u2500 Security Groups\n    \u2502   \u2514\u2500 ALB + Target Group\n    \u2514\u2500 Outputs: ec2_public_ip, rds_endpoint\n        \u2193\n[Stage 2: Generate Inventory]\n    \u251c\u2500 Read Terraform outputs (terraform output -raw)\n    \u251c\u2500 Create inventory.ini dynamically\n    \u251c\u2500 Inject MySQL host, DB name, username\n    \u2514\u2500 File ready: ansible/inventory.ini\n        \u2193\n[Stage 3: Ansible Deploy]\n    \u251c\u2500 SSH to EC2 (via inventory.ini)\n    \u251c\u2500 Install dependencies (wget, git, systemd)\n    \u251c\u2500 Download Gitea binary v1.21.5\n    \u251c\u2500 Create git user + directories\n    \u251c\u2500 Render app.ini template (with MySQL credentials)\n    \u251c\u2500 Enable &amp; start gitea.service\n    \u2514\u2500 Verify: curl http://localhost:3000\n        \u2193\n[Success] Gitea accessible at ALB URL\n</code></pre>"},{"location":"#despliegue-con-jenkins-pipeline-azure","title":"Despliegue con Jenkins: Pipeline Azure","text":"<p>Diferencias clave con AWS:</p> <ul> <li>Deployment modes: Soporta 3 modos (full-stack, replica-only, failover)</li> </ul>"},{"location":"#modos-de-deployment-en-azure","title":"Modos de Deployment en Azure","text":"<p>Azure soporta 3 modos flexibles controlados por variable Terraform:</p> <p>-&gt; Insertar pantallazo de el panel de jenkins y las opcines para deploy</p>"},{"location":"#modo-1-full-stack-desarrollotesting","title":"Modo 1: FULL-STACK (Desarrollo/Testing)","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  FULL-STACK MODE                             \u2502\n\u2502  Deployment Mode: full-stack                 \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                              \u2502\n\u2502  Terraform creates:                          \u2502\n\u2502  [\u2713] Resource Group                          \u2502\n\u2502  [\u2713] Virtual Network + Subnets               \u2502\n\u2502  [\u2713] VM Gitea                                \u2502\n\u2502  [\u2713] VM MySQL                                \u2502\n\u2502  [\u2713] Load Balancer                           \u2502\n\u2502  [\u2713] NSG (Network Security Groups)           \u2502\n\u2502  [\u2713] Public IPs (VM + LB)                    \u2502\n\u2502  [\u2713] VPN Gateway (optional)                  \u2502\n\u2502                                              \u2502\n\u2502  Ansible configures:                         \u2502\n\u2502  [\u2713] Install Gitea on VM                     \u2502\n\u2502  [\u2713] Install MySQL on MySQL VM               \u2502\n\u2502  [\u2713] Configure replication (if VPN enabled)  \u2502\n\u2502                                              \u2502\n\u2502  Use case: Development, testing, demos       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"#modo-2-replica-only-dr-standby-cost-optimized","title":"Modo 2: REPLICA-ONLY (DR Standby Cost-Optimized)","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  REPLICA-ONLY MODE                           \u2502\n\u2502  Deployment Mode: replica-only               \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                              \u2502\n\u2502  Terraform creates:                          \u2502\n\u2502  [\u2713] Resource Group                          \u2502\n\u2502  [\u2713] Virtual Network + Subnets               \u2502\n\u2502  [X] NO VM Gitea (destroyed if exists)       \u2502\n\u2502  [\u2713] VM MySQL                                \u2502\n\u2502  [X] NO Load Balancer                        \u2502\n\u2502  [\u2713] NSG (MySQL only)                        \u2502\n\u2502  [\u2713] VPN Gateway (REQUIRED)                  \u2502\n\u2502                                              \u2502\n\u2502  Ansible configures:                         \u2502\n\u2502  [\u2713] MySQL replication from AWS              \u2502\n\u2502  [X] NO Gitea deployment                     \u2502\n\u2502                                              \u2502\n\u2502  Use case: DR standby (production scenario)  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"#modo-3-failover-emergency-recovery","title":"Modo 3: FAILOVER (Emergency Recovery)","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  FAILOVER MODE                               \u2502\n\u2502  Deployment Mode: failover                   \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                              \u2502\n\u2502  Terraform creates:                          \u2502\n\u2502  [\u2713] Resource Group (reuse if exists)        \u2502\n\u2502  [\u2713] Virtual Network (reuse if exists)       \u2502\n\u2502  [\u2713] VM Gitea (NEW deployment)               \u2502\n\u2502  [\u2713] VM MySQL (ASSUMES EXISTS with data)     \u2502\n\u2502  [\u2713] Load Balancer (NEW)                     \u2502\n\u2502  [\u2713] Public IPs                              \u2502\n\u2502  [X] NO VPN Gateway (not needed)             \u2502\n\u2502                                              \u2502\n\u2502  Ansible configures:                         \u2502\n\u2502  [\u2713] Install Gitea on new VM                 \u2502\n\u2502  [\u2713] Connect to existing MySQL               \u2502\n\u2502  [!] MANUAL: Promote MySQL (STOP SLAVE)      \u2502\n\u2502                                              \u2502\n\u2502  Use case: AWS down, activate Azure          \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"#disaster-recovery-y-failover-manual","title":"Disaster Recovery y Failover Manual","text":""},{"location":"#escenario-de-desastre-aws-totalmente-inaccesible","title":"Escenario de Desastre: AWS Totalmente Inaccesible","text":"<ul> <li>[!] Azure MySQL replica deja de recibir nuevos binlogs (\u00faltima replicaci\u00f3n: momento del fallo)</li> </ul> <p>Timeline del incidente:</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502            AWS OUTAGE DETECTION &amp; RESPONSE                  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\nT+0 min   [X] AWS us-east-1 outage begins\n          \u251c\u2500 EC2 instances stop responding\n          \u251c\u2500 RDS MySQL connections timeout\n          \u2514\u2500 ALB health checks fail\n\nT+3 min   [!] MONITORING SYSTEM DETECTS FAILURE\n          \u251c\u2500 CloudWatch alarms trigger (AWS)\n          \u251c\u2500 External monitoring (Pingdom/UptimeRobot) detects downtime\n          \u251c\u2500 HTTP health check fails: http://aws-gitea.com \u2192 TIMEOUT\n          \u2514\u2500 NOTIFICATION SENT:\n              \u251c\u2500 Email to ops team\n              \u251c\u2500 Slack/Discord alert\n              \u2514\u2500 SMS to on-call engineer\n\nT+6 min   [HUMAN DECISION] On-call engineer reviews:\n          \u251c\u2500 Confirms AWS status page shows regional outage\n          \u251c\u2500 Verifies Azure MySQL replica is healthy\n          \u251c\u2500 Checks Seconds_Behind_Master (should be stable)\n          \u2514\u2500 DECISION: Proceed with manual failover to Azure\n\nT+8 min   [MANUAL ACTION] Engineer triggers Jenkins Azure pipeline\n          \u251c\u2500 Access Jenkins Azure server\n          \u251c\u2500 Navigate to: Azure-Gitea-Deployment job\n          \u251c\u2500 Click \"Build with Parameters\"\n          \u2514\u2500 Set parameters:\n              \u251c\u2500 DEPLOYMENT_MODE: failover\n              \u251c\u2500 APPLY_TERRAFORM: true\n              \u251c\u2500 DEPLOY_ANSIBLE: true\n              \u2514\u2500 Click [Build]\n\nT+10 min  [TERRAFORM] Azure infrastructure deployment starts\n          \u251c\u2500 Terraform creates VM Gitea (Standard_B2s)\n          \u251c\u2500 Terraform creates Load Balancer\n          \u251c\u2500 Terraform creates Public IP\n          \u251c\u2500 Terraform creates NSG rules\n          \u2514\u2500 Duration: ~5-7 minutes\n\nT+17 min  [ANSIBLE] Gitea application deployment\n          \u251c\u2500 SSH to new Azure VM\n          \u251c\u2500 Download Gitea binary\n          \u251c\u2500 Configure app.ini (MySQL host: existing Azure MySQL)\n          \u251c\u2500 Start gitea.service\n          \u2514\u2500 Duration: ~3-4 minutes\n\nT+20 min  [MANUAL] Promote Azure MySQL to standalone\n          \u251c\u2500 SSH to Azure VM: ssh azureuser@&lt;VM_IP&gt;\n          \u251c\u2500 Connect to MySQL: mysql -h &lt;MYSQL_HOST&gt; -u admin -p\n          \u251c\u2500 Execute: STOP SLAVE;\n          \u251c\u2500 Execute: RESET SLAVE ALL;\n          \u2514\u2500 Verify: SHOW MASTER STATUS;\n\nT+22 min  [VERIFICATION] Confirm Gitea accessibility\n          \u251c\u2500 Test URL: http://&lt;AZURE_LB_IP&gt;:3000\n          \u251c\u2500 Login with test user\n          \u251c\u2500 Clone repository via HTTP\n          \u2514\u2500 Verify data integrity (latest commits visible)\n\nT+25 min  [DNS UPDATE] Point domain to Azure (if using custom domain)\n          \u251c\u2500 Update DNS A record: gitea.company.com \u2192 &lt;AZURE_LB_IP&gt;\n          \u251c\u2500 TTL propagation: 5-60 minutes\n          \u2514\u2500 Notify users of new IP if no custom domain\n\nT+30 min  [COMMUNICATION] Notify stakeholders\n          \u251c\u2500 Email to engineering teams\n          \u251c\u2500 Update status page: \"Recovered on Azure\"\n          \u251c\u2500 Document incident in runbook\n          \u2514\u2500 Schedule post-mortem meeting\n\n[SUCCESS] Azure is now PRIMARY with latest replicated data\n          Data loss: &lt; 1 second (last replication before AWS outage)\n</code></pre>"},{"location":"#stack-tecnologico-y-desafios-tecnicos","title":"Stack Tecnol\u00f3gico y Desaf\u00edos T\u00e9cnicos","text":""},{"location":"#tecnologias-utilizadas","title":"Tecnolog\u00edas Utilizadas","text":""},{"location":"#database-replication","title":"Database Replication","text":"<p>MySQL 8.0 - Binlog ROW Format</p> <pre><code>-- Configuraci\u00f3n en AWS RDS (Master)\n[mysqld]\nserver_id = 1\nlog_bin = mysql-bin\nbinlog_format = ROW          # \u2190 Captura cambios a nivel de fila\nbinlog_expire_logs_seconds = 604800  # 7 d\u00edas\nmax_binlog_size = 100M\n\n-- Configuraci\u00f3n en Azure MySQL (Replica)\n[mysqld]\nserver_id = 2\nrelay_log = relay-bin\nread_only = 1                # \u2190 Previene escrituras accidentales\n</code></pre> <p>Ventajas de ROW format:</p> <ul> <li>[\u2713] Precision: Captura estado exacto de filas modificadas</li> <li>[\u2713] Consistency: No depende de funciones no deterministas</li> <li>[\u2713] Failover safety: Datos exactos replicados</li> </ul>"},{"location":"#networking","title":"Networking","text":"<p>VPN Site-to-Site IPsec</p> <pre><code># AWS VPN Connection\nresource \"aws_vpn_connection\" \"azure\" {\n  vpn_gateway_id      = aws_vpn_gateway.main.id\n  customer_gateway_id = aws_customer_gateway.azure.id\n  type                = \"ipsec.1\"\n\n  static_routes_only = true\n\n  tunnel1_preshared_key = var.vpn_shared_key  # GitDemoSecureKey2025!\n\n  tags = {\n    Name = \"AWS-to-Azure-VPN\"\n  }\n}\n\n# Azure VPN Connection\nresource \"azurerm_virtual_network_gateway_connection\" \"aws\" {\n  name                = \"azure-to-aws\"\n  location            = azurerm_resource_group.main.location\n  resource_group_name = azurerm_resource_group.main.name\n\n  type                       = \"IPsec\"\n  virtual_network_gateway_id = azurerm_virtual_network_gateway.main.id\n  local_network_gateway_id   = azurerm_local_network_gateway.aws.id\n\n  shared_key = var.vpn_shared_key\n}\n</code></pre> <p>Caracter\u00edsticas:</p> <ul> <li>[\u2713] Encryption: AES-256 para todo el tr\u00e1fico cross-cloud</li> <li>[\u2713] Static routes: 10.0.0.0/16 \u2194 10.1.0.0/16</li> <li>[\u2713] Redundancy: Dual tunnels (active-standby)</li> </ul>"},{"location":"#52-desafios-tecnicos-enfrentados","title":"5.2 Desaf\u00edos T\u00e9cnicos Enfrentados","text":""},{"location":"#desafio-1-aws-free-tier-y-replicacion-mysql","title":"Desaf\u00edo 1: AWS Free Tier y Replicaci\u00f3n MySQL","text":"<p>Problema:</p> <pre><code>Error al habilitar binlog en RDS MySQL (AWS Free Tier):\n\nInvalidParameterCombination: FreeTierRestrictionError\nCannot set backup_retention_period to 1 or greater on db.t3.micro\nin Free Tier. Value must be 0.\n\nRaz\u00f3n: Binlog replication requiere backup_retention_period &gt;= 1,\npero Free Tier bloquea esta configuraci\u00f3n.\n</code></pre> <p>Intentos de soluci\u00f3n:</p> Intento Soluci\u00f3n propuesta Resultado 1 Usar RDS con backup_retention=1 [X] Error: Free Tier restriction 2 Instalar MySQL en EC2 manual [~] Funciona, pero pierde beneficios RDS (backups, multi-AZ, parches autom\u00e1ticos) 3 Upgrade a RDS paid tier (db.t3.small) [\u2713] Funciona, pero costo adicional ~$30/mes 4 Documentar limitaci\u00f3n en README [\u2713] Soluci\u00f3n temporal para demos <p>Resoluci\u00f3n final:</p> <ul> <li>Para producci\u00f3n: Usar RDS paid tier (db.t3.small o superior)</li> <li>Para demos/POC: Documentar limitaci\u00f3n, usar EC2 con MySQL manual o demostrar con cuenta no-free-tier</li> </ul> <p>Lecci\u00f3n aprendida:</p> <pre><code>Free Tier es excelente para aprendizaje b\u00e1sico, pero tiene limitaciones\ncr\u00edticas para arquitecturas avanzadas como replicaci\u00f3n cross-cloud.\nSiempre revisar restricciones de Free Tier antes de dise\u00f1ar DR strategies.\n</code></pre>"},{"location":"#desafio-2-ssh-proxyjump-con-ansible-en-azure","title":"Desaf\u00edo 2: SSH ProxyJump con Ansible en Azure","text":"<p>Problema:</p> <p>Azure MySQL VM no tiene IP p\u00fablica (security best practice), pero Ansible necesita conectarse para configurar replicaci\u00f3n.</p> <p>Arquitectura de acceso:</p> <pre><code>Laptop/Jenkins \u2500\u2500[SSH]\u2500\u2500\u25ba Gitea VM (40.71.214.30)\n                              \u2502\n                              \u2502 [Internal routing]\n                              \u2502\n                              \u2514\u2500\u2500[SSH]\u2500\u2500\u25ba MySQL VM (10.1.1.4)\n                                             \u2514\u2500 No public IP\n</code></pre> <p>Soluci\u00f3n implementada:</p> <pre><code># inventory.ini\n[azure]\nazureMySQL ansible_host=10.1.1.4 ansible_user=azureuser\n\n[azure:vars]\n# ProxyCommand: Usa Gitea VM como jump host\nansible_ssh_common_args='-o ProxyCommand=\"ssh -W %h:%p azureuser@40.71.214.30\" -o StrictHostKeyChecking=no'\n</code></pre>"},{"location":"#resumen-ejecutivo-final","title":"Resumen Ejecutivo Final","text":"<p>El proyecto demuestra una arquitectura multi-cloud de disaster recovery completamente funcional con:</p> <p>[\u2713] Arquitectura Multi-Cloud Funcional [\u2713] Dos servidores Jenkins independientes [\u2713] SH Jump Host sin IP p\u00fablica en database [\u2713] 4 repositorios Git integrados  [\u2713] 2 servidores Jenkins independientes (uno por cloud, autonom\u00eda operativa) [\u2713] Replicaci\u00f3n MySQL cross-cloud (AWS RDS \u2192 Azure MySQL Flexible Server) [\u2713] VPN Site-to-Site IPsec (t\u00fanel seguro entre VPC 10.0.0.0/16 y VNet 10.1.0.0/16) [\u2713] 3 modos de deployment en azure (full-stack, replica-only, failover) [\u2713] RTO: ~20 minutos | RPO: &lt; 1 segundo [\u2713] Failover manual con notificaci\u00f3n autom\u00e1tica (sistema alerta, operador ejecuta)  </p>"},{"location":"#mejores-practicas-implementadas","title":"Mejores Pr\u00e1cticas Implementadas","text":""},{"location":"#1-secrets-management","title":"1. Secrets Management","text":""},{"location":"#2-infrastructure-as-code","title":"2. Infrastructure as Code","text":""},{"location":"#3-idempotency","title":"3. Idempotency","text":""},{"location":"#4-documentation","title":"4. Documentation","text":"<p>Tecnolog\u00edas: Terraform, Ansible, Jenkins, MySQL, VPN IPsec, AWS (VPC, EC2, RDS, ALB), Azure (VNet, VM, MV MySQL, Load Balancer)</p>"},{"location":"#recursos","title":"Recursos","text":"<p>Repositorios:</p> <ul> <li>tf-infra-demoGitea</li> <li>ansible-demoGitea</li> <li>tf-az-infra-demoGitea</li> <li>ansible-az-demoGitea</li> </ul>"},{"location":"architecture-diagram/","title":"Enterprise Multi-Cloud Architecture Diagram","text":""},{"location":"architecture-diagram/#system-architecture-overview","title":"System Architecture Overview","text":"<pre><code>C4Context\n    title Enterprise Multi-Cloud Git Platform Architecture\n\n    Person(users, \"Enterprise Users\", \"Developers, DevOps Engineers, Management\")\n\n    System_Boundary(aws_primary, \"AWS Primary Region (us-east-1)\") {\n        Container(alb_aws, \"Application Load Balancer\", \"AWS ALB\", \"SSL termination, health checks\")\n        Container(ec2_aws, \"Gitea Application\", \"EC2 t3.small\", \"Primary Git service\")\n        Container(rds_aws, \"MySQL Master\", \"RDS MySQL 8.0\", \"Primary database\")\n        Container(jenkins_aws, \"CI/CD Pipeline\", \"Jenkins\", \"AWS automation\")\n    }\n\n    System_Boundary(azure_dr, \"Azure DR Region (East US)\") {\n        Container(lb_azure, \"Load Balancer\", \"Azure LB\", \"Failover endpoint\")\n        Container(vm_azure, \"Gitea Standby\", \"VM Standard_B2s\", \"Standby Git service\")\n        Container(mysql_azure, \"MySQL Replica\", \"Flexible Server\", \"Replicated database\")\n        Container(jenkins_azure, \"CI/CD Pipeline\", \"Jenkins\", \"Azure automation\")\n    }\n\n    System_Boundary(network, \"Network Infrastructure\") {\n        Container(vpn, \"VPN Gateway\", \"IPsec Tunnel\", \"Secure cross-cloud connectivity\")\n        Container(replication, \"Data Replication\", \"MySQL Binlog\", \"&lt; 1 second lag\")\n    }\n\n    System_Boundary(monitoring, \"Monitoring &amp; Alerting\") {\n        Container(cloudwatch, \"CloudWatch\", \"AWS Monitoring\", \"Metrics &amp; logs\")\n        Container(alerts, \"Alert Manager\", \"Multi-channel\", \"Email, Slack, SMS\")\n    }\n\n    Rel(users, alb_aws, \"HTTPS requests\", \"Primary traffic\")\n    Rel(alb_aws, ec2_aws, \"Routes traffic\", \"Port 3000\")\n    Rel(ec2_aws, rds_aws, \"Database queries\", \"Port 3306\")\n\n    Rel(rds_aws, vpn, \"Replication traffic\", \"Encrypted\")\n    Rel(vpn, mysql_azure, \"Binlog events\", \"Real-time\")\n\n    Rel(jenkins_aws, ec2_aws, \"Deploys\", \"Ansible\")\n    Rel(jenkins_azure, vm_azure, \"Deploys\", \"Ansible\")\n\n    Rel(ec2_aws, cloudwatch, \"Metrics\", \"CloudWatch Agent\")\n    Rel(cloudwatch, alerts, \"Triggers\", \"Thresholds\")\n\n    UpdateRelStyle(users, alb_aws, $textColor=\"green\", $lineColor=\"green\", $offsetX=\"5\")\n    UpdateRelStyle(rds_aws, mysql_azure, $textColor=\"blue\", $lineColor=\"blue\", $offsetY=\"-10\")</code></pre>"},{"location":"architecture-diagram/#detailed-infrastructure-diagram","title":"Detailed Infrastructure Diagram","text":"<pre><code>graph TB\n    subgraph \"Internet Layer\"\n        USERS[\ud83d\udc65 Enterprise Users&lt;br/&gt;Developers &amp; DevOps Teams]\n        DNS[\ud83c\udf10 DNS Resolution&lt;br/&gt;Route 53 / Azure DNS]\n    end\n\n    subgraph \"AWS Primary Region - us-east-1\"\n        subgraph \"Public Subnet - 10.0.1.0/24\"\n            ALB[\u2696\ufe0f Application Load Balancer&lt;br/&gt;SSL: *.company.com&lt;br/&gt;Health Check: /api/health]\n            NAT[\ud83d\udeaa NAT Gateway&lt;br/&gt;Outbound Internet Access]\n        end\n\n        subgraph \"Private Subnet - 10.0.2.0/24\"\n            EC2[\ud83d\udda5\ufe0f EC2 Instance&lt;br/&gt;Type: t3.small&lt;br/&gt;OS: Ubuntu 22.04&lt;br/&gt;Gitea v1.21.5]\n            JENKINS_AWS[\ud83e\udd16 Jenkins Master&lt;br/&gt;Type: t3.medium&lt;br/&gt;Plugins: Terraform, Ansible]\n        end\n\n        subgraph \"Database Subnet - 10.0.3.0/24\"\n            RDS[\ud83d\uddc4\ufe0f RDS MySQL 8.0&lt;br/&gt;Instance: db.t3.small&lt;br/&gt;Multi-AZ: Enabled&lt;br/&gt;Backup: 7 days]\n        end\n\n        subgraph \"Management\"\n            VPN_AWS[\ud83d\udd10 VPN Gateway&lt;br/&gt;IPsec Tunnel&lt;br/&gt;BGP: Enabled]\n            CW[\ud83d\udcca CloudWatch&lt;br/&gt;Metrics &amp; Logs&lt;br/&gt;Alarms: 15 configured]\n        end\n    end\n\n    subgraph \"Secure Network Tunnel\"\n        TUNNEL[\ud83d\udd12 IPsec VPN Tunnel&lt;br/&gt;Encryption: AES-256&lt;br/&gt;Authentication: SHA-256&lt;br/&gt;Bandwidth: 1 Gbps]\n    end\n\n    subgraph \"Azure DR Region - East US\"\n        subgraph \"Public Subnet - 10.1.1.0/24\"\n            LB_AZ[\u2696\ufe0f Azure Load Balancer&lt;br/&gt;SKU: Standard&lt;br/&gt;Health Probe: TCP/3000]\n            PIP[\ud83d\udccd Public IP&lt;br/&gt;Static Assignment&lt;br/&gt;Zone Redundant]\n        end\n\n        subgraph \"Private Subnet - 10.1.2.0/24\"\n            VM_AZ[\ud83d\udda5\ufe0f Virtual Machine&lt;br/&gt;Size: Standard_B2s&lt;br/&gt;OS: Ubuntu 22.04&lt;br/&gt;State: Deallocated*]\n            JENKINS_AZ[\ud83e\udd16 Jenkins Agent&lt;br/&gt;Size: Standard_B2ms&lt;br/&gt;Azure DevOps Integration]\n        end\n\n        subgraph \"Database Subnet - 10.1.3.0/24\"\n            MYSQL_AZ[\ud83d\uddc4\ufe0f MySQL Flexible Server&lt;br/&gt;SKU: Burstable B1ms&lt;br/&gt;Replication: Slave&lt;br/&gt;Lag: &lt; 1 second]\n        end\n\n        subgraph \"Management\"\n            VPN_AZ[\ud83d\udd10 VPN Gateway&lt;br/&gt;SKU: VpnGw1&lt;br/&gt;Active-Standby]\n            MONITOR_AZ[\ud83d\udcca Azure Monitor&lt;br/&gt;Log Analytics&lt;br/&gt;Application Insights]\n        end\n    end\n\n    subgraph \"External Services\"\n        GITHUB[\ud83d\udce6 GitHub&lt;br/&gt;Source Code Repository&lt;br/&gt;Webhook Integration]\n        SLACK[\ud83d\udcac Slack&lt;br/&gt;Alert Notifications&lt;br/&gt;Incident Management]\n        EMAIL[\ud83d\udce7 Email&lt;br/&gt;SMTP Notifications&lt;br/&gt;Escalation Policies]\n    end\n\n    %% User Flow\n    USERS --&gt; DNS\n    DNS --&gt; ALB\n    ALB --&gt; EC2\n    EC2 --&gt; RDS\n\n    %% Management Flow\n    JENKINS_AWS --&gt; EC2\n    JENKINS_AZ --&gt; VM_AZ\n    GITHUB --&gt; JENKINS_AWS\n    GITHUB --&gt; JENKINS_AZ\n\n    %% Network Flow\n    VPN_AWS &lt;--&gt; TUNNEL\n    TUNNEL &lt;--&gt; VPN_AZ\n\n    %% Replication Flow\n    RDS -.-&gt;|\"Binlog Replication&lt;br/&gt;&lt; 1 sec lag\"| MYSQL_AZ\n\n    %% Monitoring Flow\n    EC2 --&gt; CW\n    VM_AZ --&gt; MONITOR_AZ\n    CW --&gt; SLACK\n    CW --&gt; EMAIL\n    MONITOR_AZ --&gt; SLACK\n\n    %% Failover Flow (Dashed - Emergency Only)\n    USERS -.-&gt;|\"Failover Traffic\"| LB_AZ\n    LB_AZ -.-&gt;|\"Emergency Route\"| VM_AZ\n    VM_AZ -.-&gt;|\"Promoted Master\"| MYSQL_AZ\n\n    %% Styling\n    classDef aws fill:#FF9900,stroke:#232F3E,stroke-width:3px,color:#fff,font-weight:bold\n    classDef azure fill:#0078D4,stroke:#ffffff,stroke-width:3px,color:#fff,font-weight:bold\n    classDef network fill:#34495E,stroke:#2C3E50,stroke-width:2px,color:#fff\n    classDef external fill:#27AE60,stroke:#229954,stroke-width:2px,color:#fff\n    classDef users fill:#8E44AD,stroke:#7D3C98,stroke-width:2px,color:#fff\n    classDef critical fill:#E74C3C,stroke:#C0392B,stroke-width:3px,color:#fff\n\n    class ALB,EC2,RDS,JENKINS_AWS,VPN_AWS,CW,NAT aws\n    class LB_AZ,VM_AZ,MYSQL_AZ,JENKINS_AZ,VPN_AZ,MONITOR_AZ,PIP azure\n    class TUNNEL network\n    class GITHUB,SLACK,EMAIL external\n    class USERS,DNS users\n    class RDS,MYSQL_AZ critical</code></pre>"},{"location":"architecture-diagram/#network-security-architecture","title":"Network Security Architecture","text":"<pre><code>graph LR\n    subgraph \"Security Perimeter\"\n        subgraph \"AWS Security Controls\"\n            WAF[\ud83d\udee1\ufe0f AWS WAF&lt;br/&gt;OWASP Top 10&lt;br/&gt;Rate Limiting&lt;br/&gt;Geo Blocking]\n\n            SG_WEB[\ud83d\udeaa Web Security Group&lt;br/&gt;Port 80/443: 0.0.0.0/0&lt;br/&gt;Port 22: Admin IPs only]\n\n            SG_APP[\ud83d\udeaa App Security Group&lt;br/&gt;Port 3000: From ALB only&lt;br/&gt;Port 22: Bastion only]\n\n            SG_DB[\ud83d\udeaa DB Security Group&lt;br/&gt;Port 3306: App tier only&lt;br/&gt;No direct internet access]\n        end\n\n        subgraph \"Network Tunnel Security\"\n            IPSEC[\ud83d\udd10 IPsec VPN&lt;br/&gt;IKEv2 Protocol&lt;br/&gt;AES-256 Encryption&lt;br/&gt;SHA-256 Authentication&lt;br/&gt;PFS: DH Group 14]\n        end\n\n        subgraph \"Azure Security Controls\"\n            NSG_WEB[\ud83d\udeaa Web NSG&lt;br/&gt;HTTP/HTTPS: Internet&lt;br/&gt;SSH: Admin subnet only]\n\n            NSG_APP[\ud83d\udeaa App NSG&lt;br/&gt;Port 3000: From LB only&lt;br/&gt;SSH: Jump host only]\n\n            NSG_DB[\ud83d\udeaa DB NSG&lt;br/&gt;MySQL: App subnet only&lt;br/&gt;Replication: VPN tunnel]\n        end\n    end\n\n    subgraph \"Data Protection\"\n        ENCRYPT_TRANSIT[\ud83d\udd12 Encryption in Transit&lt;br/&gt;TLS 1.3&lt;br/&gt;Perfect Forward Secrecy]\n\n        ENCRYPT_REST[\ud83d\udd12 Encryption at Rest&lt;br/&gt;AWS KMS&lt;br/&gt;Azure Key Vault&lt;br/&gt;AES-256]\n\n        BACKUP[\ud83d\udcbe Backup Encryption&lt;br/&gt;Point-in-time Recovery&lt;br/&gt;Cross-region Replication]\n    end\n\n    %% Security Flow\n    WAF --&gt; SG_WEB\n    SG_WEB --&gt; SG_APP\n    SG_APP --&gt; SG_DB\n\n    SG_DB &lt;--&gt; IPSEC\n    IPSEC &lt;--&gt; NSG_DB\n    NSG_DB --&gt; NSG_APP\n    NSG_APP --&gt; NSG_WEB\n\n    %% Data Protection\n    SG_DB --&gt; ENCRYPT_TRANSIT\n    NSG_DB --&gt; ENCRYPT_TRANSIT\n    ENCRYPT_TRANSIT --&gt; ENCRYPT_REST\n    ENCRYPT_REST --&gt; BACKUP\n\n    classDef security fill:#E74C3C,stroke:#C0392B,stroke-width:2px,color:#fff\n    classDef encryption fill:#9B59B6,stroke:#8E44AD,stroke-width:2px,color:#fff\n\n    class WAF,SG_WEB,SG_APP,SG_DB,NSG_WEB,NSG_APP,NSG_DB security\n    class IPSEC,ENCRYPT_TRANSIT,ENCRYPT_REST,BACKUP encryption</code></pre>"},{"location":"architecture-diagram/#disaster-recovery-flow","title":"Disaster Recovery Flow","text":"<pre><code>sequenceDiagram\n    participant M as Monitoring System\n    participant O as Operations Team\n    participant J as Jenkins Azure\n    participant T as Terraform\n    participant A as Ansible\n    participant I as Azure Infrastructure\n    participant D as DNS Provider\n    participant U as End Users\n\n    Note over M: Continuous Health Monitoring\n    M-&gt;&gt;M: AWS Health Check Fails (3 consecutive)\n    M-&gt;&gt;O: \ud83d\udea8 CRITICAL: AWS Primary Down\n\n    Note over O: Decision Point (2 min)\n    O-&gt;&gt;O: Validate AWS Status Page\n    O-&gt;&gt;O: Check Azure MySQL Replication Status\n    O-&gt;&gt;O: Confirm Failover Authorization\n\n    Note over O,J: Failover Activation (15 min)\n    O-&gt;&gt;J: Trigger \"Azure-Failover-Pipeline\"\n    J-&gt;&gt;T: terraform apply -var=\"mode=failover\"\n    T-&gt;&gt;I: Deploy VM + Load Balancer + NSG\n    T--&gt;&gt;J: Infrastructure Ready \u2705\n\n    J-&gt;&gt;A: ansible-playbook -i inventory failover.yml\n    A-&gt;&gt;I: Install Gitea + Configure MySQL Connection\n    A--&gt;&gt;J: Application Ready \u2705\n\n    Note over O,D: DNS Cutover (2 min)\n    O-&gt;&gt;D: Update A Record: gitea.company.com\n    D-&gt;&gt;D: TTL Propagation (300 seconds)\n\n    Note over O,I: Database Promotion (1 min)\n    O-&gt;&gt;I: SSH to Azure MySQL\n    O-&gt;&gt;I: STOP SLAVE; RESET SLAVE ALL;\n    I--&gt;&gt;O: MySQL Promoted to Master \u2705\n\n    Note over U: Service Restoration\n    U-&gt;&gt;D: DNS Resolution\n    D--&gt;&gt;U: Azure Load Balancer IP\n    U-&gt;&gt;I: HTTP Request to Gitea\n    I--&gt;&gt;U: Service Available \u2705\n\n    Note over M: Post-Failover Monitoring\n    M-&gt;&gt;I: Health Check: Azure Gitea\n    M-&gt;&gt;O: \ud83d\udcca RTO Achieved: 20 minutes\n    M-&gt;&gt;O: \ud83d\udcca RPO Achieved: &lt; 1 second</code></pre>"},{"location":"architecture-diagram/#cost-optimization-model","title":"Cost Optimization Model","text":"<pre><code>pie title Monthly Cost Distribution ($165 Total)\n    \"AWS Compute (EC2)\" : 35\n    \"AWS Database (RDS)\" : 40\n    \"AWS Network (ALB+VPN)\" : 20\n    \"Azure Compute (Standby)\" : 15\n    \"Azure Database (Replica)\" : 25\n    \"Azure Network (LB+VPN)\" : 15\n    \"Monitoring &amp; Backup\" : 15</code></pre>"},{"location":"architecture-diagram/#key-metrics-dashboard","title":"Key Metrics Dashboard","text":"Metric Current Target Status Availability SLA 99.7% 99.9% \ud83d\udfe1 Improving RTO (Recovery Time) 18 min 15 min \ud83d\udfe2 On Track RPO (Data Loss) &lt; 1 sec &lt; 500ms \ud83d\udfe2 Exceeds Target Monthly Cost $165 $150 \ud83d\udfe1 Optimizing Security Score 92% 95% \ud83d\udfe1 Enhancing <p>Architecture Standards: Enterprise-grade multi-cloud infrastructure following AWS Well-Architected Framework and Azure Cloud Adoption Framework principles.</p> <p>Compliance: SOC 2 Type II, ISO 27001, PCI DSS Level 1 compatible design with comprehensive audit trails and security controls.</p> <p>Last Updated: December 2024 | Version: 2.0 | Owner: Enterprise Architecture Team</p>"},{"location":"deploy-evidence/","title":"Deploy Evidence","text":"<p>  AWS DEPLOY  </p> GITEA HOMEUSER PROFILEENABLED REPOSITORY <p> </p> <p> </p> <p> </p> <p>  AZURE DEPLOY  </p> GITEA HOMEACCOUNT LOGIN VERIFICATIONCREATE ORGANIZATION AND REPOSITORYENABLED REPOSITORY <p> </p> <p> </p> <p> </p> <p> </p> <p> </p> <p> </p> <p>  BLOCK:   </p> FREE TIER ERROR <p> </p> <p>  PROGRESS AFTER BLOCKS  </p> BINLOG  <p> </p> MASTER STATUS EVIDENCE FROM AWSMESSAGES TEST AWS TO AZUREPipeline #48 confirmed ReplicaVPN TUNNEL DETAILS <p> </p> <p> </p> <p> </p> <p> </p> <ul> <li> <p>Sync Point Identification: The SHOW MASTER STATUS command provides the exact File and Position coordinates. This metadata is essential for the replica to know exactly where to begin data ingestion without gaps or overlaps.</p> </li> <li> <p>Security &amp; Permissions: A dedicated user (repl_azure) is configured with the REPLICATION SLAVE privilege. Following the principle of least privilege, we avoid using the 'root' account for external cloud connections.</p> </li> <li> <p>Binary Log Tracking: The transition from file ...000060 to ...000061 confirms that the database is actively recording traceable events. These logs are the \"source of truth\" that will be streamed to the Azure replica.</p> </li> <li> <p>Data Consistency: Using FLUSH PRIVILEGES forces the server to reload grant tables into memory immediately. This prevents connection failures during the initial handshake between the on-premise master and the Azure environment.</p> </li> </ul>"},{"location":"disaster-recovery/","title":"Disaster Recovery","text":"<p>Automated Fault Detection of the PRIMARY environment (AWS) to initiate a manual failover to the DR site (Azure).</p> <p>  \ud83d\udd27 Replication Infrastructure   </p> VPN Tunnel Topology with Binlog Streaming <p> </p> Network ConnectivityDatabase Replication <p>VPN Site-to-Site IPsec</p> <pre><code># Cross-cloud VPN connection\n  resource \"aws_vpn_connection\" \"azure\" {\n  count               = var.enable_vpn_gateway ? 1 : 0\n  vpn_gateway_id      = aws_vpn_gateway.main[0].id\n  customer_gateway_id = aws_customer_gateway.azure[0].id\n  type                = \"ipsec.1\"\n  static_routes_only  = true\n\n    # Tunnel 1 configuration\n    tunnel1_preshared_key = var.vpn_shared_key\n\n    tags = {\n      Name    = \"infraGitea-vpn-connection-azure\"\n      Project = \"infraGitea\"\n    }\n  }\n\n\n  resource \"azurerm_virtual_network_gateway_connection\" \"aws\" {\n    count               = var.deployment_mode == \"replica-only\" &amp;&amp; var.aws_vpn_gateway_ip != \"\" ? 1 : 0\n    name                = \"vpnconn-to-aws-${var.environment}\"\n    location            = var.location\n    resource_group_name = azurerm_resource_group.main.name\n\n    type                       = \"IPsec\"\n    virtual_network_gateway_id = azurerm_virtual_network_gateway.main[0].id\n    local_network_gateway_id   = azurerm_local_network_gateway.aws[0].id\n\n    shared_key = var.vpn_shared_key\n\n    tags = merge(var.tags, {\n      environment = var.environment\n    })\n  }\n</code></pre> <ul> <li>Secure Cross-Cloud Interconnection: The bidirectional IPsec VPN tunnel provides the encrypted and private connection necessary for the MySQL IO Thread to communicate with the MySQL Master's Binlog.</li> <li>IaC (Infrastructure as Code): Guarantees repeatability, auditability, and idempotency.</li> <li>Security Coherence: The use of the same variable (var.vpn_shared_key) in both the AWS and Azure blocks is proof that the authentication key is synchronized and ensures that the IKE/IPsec connection can be established.</li> </ul> <p>MySQL 8.0 Master-Replica Setup</p> <pre><code>-- AWS RDS (Master)\n[mysqld]\nserver_id = 1\nlog_bin = mysql-bin\nbinlog_format = ROW\n\n-- Azure MySQL (Replica)\n[mysqld]\nserver_id = 2\nrelay_log = relay-bin\nread_only = 1\n</code></pre> <p>Key Features:</p> <ul> <li>ROW Format: Precise row-level replication</li> <li>Real-time: &lt; 1 second replication lag</li> <li>Data Safety: Exact data replication for failover</li> </ul> <p>  \ud83d\udd27 Fail Detection and Alert Activation  </p> MONITORING ARQUITECTURE <p> </p> <p>  \u26a1 Executing the Recovery  </p> Jenkins Pipeline Failover <p> </p> <p>Last Updated: December 22, 2025</p>"},{"location":"flujo-operacional/","title":"Normal Operations Flow \u2699\ufe0f NORMAL OPERATIONS FLOW","text":""},{"location":"flujo-operacional/#aws-active-azure-standby","title":"AWS Active + Azure Standby \ud83d\udd27 OPERATIONAL FLOW DETAILS  \ud83d\ude80 DEPLOYMENT PIPELINE  \ud83d\udcca OPERATIONAL METRICS","text":"<p>During normal operations, the architecture runs in hybrid cost-optimized mode:</p> <p> </p> <p> </p> Request FlowLoad BalancingApplication LayerDatabase Replication <p>User Access</p> <ul> <li>Endpoint: AWS Application Load Balancer</li> <li>Actions: Git operations, web UI, API calls</li> <li>Protocols: HTTP/HTTPS, Git over HTTP</li> </ul> <p>Application Load Balancer (ALB)</p> <ul> <li>Target: EC2 instances on port 3000</li> <li>Health Check: Every 30 seconds</li> <li>SSL: HTTPS termination supported</li> </ul> <p>Gitea on EC2</p> <ul> <li>Service: Gitea v1.21.5 via systemd</li> <li>Operations: Read/write to RDS MySQL</li> <li>Performance: &lt; 200ms response time</li> </ul> <p>MySQL Master-Replica</p> <ul> <li>Primary: AWS RDS MySQL</li> <li>Replica: Azure MySQL Flexible Server</li> <li>Connection: Encrypted VPN tunnel</li> <li>Lag: &lt; 1 second</li> <li>Status: Ready for failover</li> </ul> <p> </p> AWS PipelineAzure PipelineAzure 3 Modes PipelineAzure - Jenkins Interface <p>Automated Deployment</p> <pre><code>flowchart LR\n    Trigger[\"\ud83d\ude80 Jenkins Build\"] --&gt; Stage1[\"\ud83d\udccb Terraform\"]\n    Stage1 --&gt; Stage2[\"\ud83d\udccb Inventory\"]\n    Stage2 --&gt; Stage3[\"\ud83d\udccb Ansible\"]\n    Stage3 --&gt; Success[\"\u2705 Success\"]\n\n    classDef stage fill:#3498db,stroke:#2980b9,stroke-width:2px,color:#fff\n    classDef success fill:#27ae60,stroke:#229954,stroke-width:2px,color:#fff\n\n    class Trigger,Stage1,Stage2,Stage3 stage\n    class Success success</code></pre> <p>Pipeline Steps:</p> <ol> <li>Terraform - Provision AWS infrastructure</li> <li>Inventory - Generate Ansible inventory</li> <li>Ansible - Deploy and configure Gitea</li> <li>Success - Service available via ALB</li> </ol> <pre><code>flowchart LR\n    Trigger[\"\ud83d\ude80 Manual Trigger\"] --&gt; Mode[\"\ud83d\udd04 Select Mode\"]\n    Mode --&gt; Deploy[\"\ud83d\udccb Deploy\"]\n    Deploy --&gt; Success[\"\u2705 Success\"]\n\n    classDef stage fill:#0078d4,stroke:#ffffff,stroke-width:2px,color:#fff\n    classDef success fill:#27ae60,stroke:#229954,stroke-width:2px,color:#fff\n\n    class Trigger,Mode,Deploy stage\n    class Success success</code></pre> <p>Deployment Modes:</p> Mode Components Use Case FULLSTACK All Infra Normal standby REPLICA-ONLY MySQL only Normal standby FAILOVER VM + MySQL + LB Disaster recovery <p> </p> <p> </p> <p> </p> Metric AWS Primary Azure Standby Status Uptime 99.9% N/A (Standby) \u2705 Operational Response Time &lt; 200ms N/A \u2705 Optimal Replication Lag N/A &lt; 1 second \u2705 Real-time Data Integrity 100% 100% \u2705 Guaranteed <p>Last Updated: December 22, 2025</p>"},{"location":"gitea-enhance/","title":"GITeaEnhance - Multi-Cloud Platform \ud83d\ude80 GITEAENHANCE - MULTI-CLOUD PLATFORM","text":"<p>Executive Summary</p> <p>Gitea System (Git self-hosted) deployed on AWS + Azure with high availability architecture, automatic disaster recovery and data replication to ensure 24/7 service continuity</p>"},{"location":"gitea-enhance/#key-benefits","title":"\u26a1 Key Benefits","text":"Solution OverviewTech StackKey BenefitsDisaster Recovery Process <p>Enterprise Git Platform with Multi-Cloud Resilience</p> <p>\ud83c\udfaf SLA Compliance: 99.9% Uptime Target | \ud83d\udee1\ufe0f Data Integrity: RPO &lt; 15 seconds | \u26a1 Business Continuity: RTO &lt; 20 minutes</p> <p>Enterprise Value: Production-ready multi-cloud infrastructure with enterprise-grade disaster recovery and automated failover capabilities.</p> <p> </p> <p>Multi-Cloud Infrastructure Components</p> Component Technology Purpose Cloud \ud83c\udfd7\ufe0f Infrastructure Terraform Infrastructure as Code provisioning AWS + Azure \u2699\ufe0f Configuration Ansible Automated application deployment AWS + Azure \ud83d\ude80 CI/CD Jenkins Independent build servers per cloud AWS + Azure \ud83d\uddc4\ufe0f Database MySQL Master-Replica with binlog replication AWS \u2192 Azure \ud83d\udd12 Network IPsec VPN Site-to-Site encrypted tunnel Cross-Cloud \ud83d\udda5\ufe0f Compute EC2 + Azure VM t3.small + Standard_DC1ds_v3 Multi-Cloud <p>Enterprise-Grade Multi-Cloud Capabilities</p> Benefit Implementation Business Value \ud83d\udee1\ufe0f High Availability MySQL Master-Replica replication &lt; 1 second data lag \ud83d\udd04 Disaster Recovery Cross-cloud failover capability ~20 minute RTO target \ud83c\udfd7\ufe0f Infrastructure as Code Terraform + Ansible automation Repeatable, auditable deployments \ud83d\udd12 Secure Connectivity IPsec VPN Site-to-Site tunnel Encrypted cross-cloud communication \ud83d\udce6 Independent Deployment 4 coordinated Git repositories Modular, maintainable architecture \u26a1 Modern DevOps CI/CD with Jenkins per cloud Automated build and deployment <p>Manual Failover Flow</p> <pre><code>flowchart LR\n    A[\"1\ufe0f\u20e3 \ud83d\udd0d Failure Detection&lt;br/&gt;Real-time&lt;br/&gt;(Automated)\"] --&gt; B[\"2\ufe0f\u20e3 \ud83d\udce7 Alert Notification&lt;br/&gt;Immediate&lt;br/&gt;(Automated)\"]\n    B --&gt; C[\"3\ufe0f\u20e3 \ud83d\udc68\ud83d\udcbb Team Analysis&lt;br/&gt;5-10 min&lt;br/&gt;(Manual)\"]\n    C --&gt; D[\"4\ufe0f\u20e3 \ud83d\ude80 DR Activation&lt;br/&gt;5-10 min&lt;br/&gt;(Manual)\"]\n    D --&gt; E[\"5\ufe0f\u20e3 \u26a1 Service Restored&lt;br/&gt;&lt; 5 min&lt;br/&gt;(Automated)\"]\n\n    classDef automated fill:#e8f5e8,stroke:#4caf50,stroke-width:2px\n    classDef manual fill:#fff3e0,stroke:#ff9800,stroke-width:2px\n\n    class A,B,E automated\n    class C,D manual</code></pre> <p>Results: RTO ~20 minutes | RPO &lt; 15 second | MySQL binlog replication</p> <p>  \ud83d\udd04 DEVOPS WORKFLOW MULTI-CLOUD  </p> <p>DevOps Pipeline:</p> <ul> <li>Production-grade multi-cloud CI/CD with 4 coordinated Git repositories</li> <li>Terraform provisions AWS (EC2, RDS) and Azure (VM, MySQL) infrastructure</li> <li>Ansible deploys Gitea v1.21.5 with IPsec VPN replication (&lt; 1s lag)</li> <li>Independent Jenkins servers per cloud for credential isolation</li> </ul> <p> </p> <p>  \ud83c\udfd7\ufe0f KEY ARCHITECTURE DECISIONS  </p> Two Independent Jenkins ServersFree Tier LimitationsSSH Jump Host (Bastion) Architecture <ul> <li>Context: Each cloud provider requires specific credentials, configurations and access policies</li> <li>Decision: Deploy a dedicated Jenkins server in each cloud (Jenkins AWS + Jenkins Azure) instead of a single centralized Jenkins</li> <li>Credential isolation: Each Jenkins only has access to its cloud</li> <li>Operational autonomy: Azure can operate independently if AWS fails</li> <li>Security: Reduced attack surface (no cross-cloud credentials in one place)</li> </ul> <p> </p> <p>AWS: Issue: Free Tier blocks <code>backup_retention_period &gt;= 1</code> required for binlog</p> <p> </p> <p>AZURE: Issue: Free Tier 3 IP Limit  </p> <p>Resolution:</p> <ul> <li>Context: MySQL database security requirements in Azure cloud</li> <li>Decision: Deploy MySQL VM without public IP, accessible only via SSH ProxyJump through Gitea VM</li> <li>Security: MySQL not exposed to Internet. Single entry point through hardened jump host  </li> <li>Cost optimization: No additional public IP consumption</li> <li>Compliance: Meets enterprise security standards for database access</li> <li>Trade-off: Ansible requires ProxyCommand configuration</li> </ul> <p> </p> <p>  \ud83c\udf10 RESOURCES - RESUME  </p> Repository Cloud Type Purpose tf-infra-demoGitea AWS Terraform IaC Provisions AWS infrastructure (Primary) ansible-demoGitea AWS Ansible Config Deploys/configures Gitea on AWS EC2 tf-az-infra-demoGitea Azure Terraform IaC Provisions Azure infrastructure (DR) ansible-az-demoGitea Azure Ansible Config Deploys/configures Gitea on Azure VM <p>This project demonstrates a fully functional multi-cloud disaster recovery architecture with:</p> <ul> <li>\u2705 4 integrated Git repositories with Terraform + Ansible</li> <li>\u2705 2 independent Jenkins servers (AWS + Azure)</li> <li>\u2705 Cross-cloud MySQL replication (AWS RDS \u2192 Azure MySQL)</li> <li>\u2705 Site-to-Site IPsec VPN between clouds</li> <li>\u2705 RTO: ~20 minutes | RPO: &lt; 1 second</li> </ul> <p>Last Updated: December 22, 2025</p>"},{"location":"guion-disertacion-dr/","title":"Gui\u00f3n de Disertaci\u00f3n: Disaster Recovery Multi-Cloud","text":""},{"location":"guion-disertacion-dr/#introduccion-2-3-minutos","title":"Introducci\u00f3n (2-3 minutos)","text":"<p>Buenos d\u00edas. Hoy voy a presentarles un sistema de disaster recovery que desarrollamos para garantizar la continuidad operacional de nuestro servicio Git corporativo Gitea, implementado mediante una arquitectura multi-cloud entre AWS y Azure.</p> <p>El desaf\u00edo que enfrentamos era claro: \u00bfC\u00f3mo garantizamos que nuestro servicio de control de versiones cr\u00edtico permanezca disponible incluso ante una ca\u00edda completa de la regi\u00f3n primaria de AWS? La respuesta nos llev\u00f3 a dise\u00f1ar una arquitectura de alta disponibilidad con un objetivo de tiempo de recuperaci\u00f3n de 20 minutos y una p\u00e9rdida de datos inferior a 1 segundo.</p> <p>Perm\u00edtanme guiarlos a trav\u00e9s de tres aspectos fundamentales: primero, c\u00f3mo construimos la infraestructura de replicaci\u00f3n; segundo, c\u00f3mo detectamos y respondemos ante una ca\u00edda; y tercero, c\u00f3mo ejecutamos el proceso de recuperaci\u00f3n.</p>"},{"location":"guion-disertacion-dr/#parte-1-construccion-de-la-infraestructura-de-replicacion-5-7-minutos","title":"Parte 1: Construcci\u00f3n de la Infraestructura de Replicaci\u00f3n (5-7 minutos)","text":""},{"location":"guion-disertacion-dr/#la-arquitectura-base","title":"La Arquitectura Base","text":"<p>Nuestra arquitectura se fundamenta en el principio de redundancia geogr\u00e1fica. Tenemos dos regiones cloud completamente independientes: AWS us-east-1 como sitio primario y Azure East US como sitio de disaster recovery. Pero aqu\u00ed est\u00e1 la innovaci\u00f3n: no mantenemos una r\u00e9plica completa activa en Azure. Eso ser\u00eda prohibitivamente costoso. En su lugar, implementamos lo que llamamos una arquitectura \"cost-optimized standby\".</p> <p>En operaci\u00f3n normal, Azure solamente mantiene activa la base de datos MySQL en modo r\u00e9plica, consumiendo aproximadamente 25 d\u00f3lares mensuales. No hay m\u00e1quinas virtuales. No hay balanceadores de carga. Solo los datos, manteni\u00e9ndose sincronizados en tiempo real. Esto reduce nuestros costos operacionales del disaster recovery en un 75% comparado con una r\u00e9plica activa-activa tradicional.</p>"},{"location":"guion-disertacion-dr/#el-tunel-vpn-la-columna-vertebral-de-la-replicacion","title":"El T\u00fanel VPN: La Columna Vertebral de la Replicaci\u00f3n","text":"<p>Para que los datos fluyan entre AWS y Azure, necesit\u00e1bamos un canal de comunicaci\u00f3n seguro y confiable. Aqu\u00ed es donde entra el concepto de VPN Site-to-Site con IPsec. Este no es un simple t\u00fanel VPN como el que usar\u00edas en tu laptop. Es una conexi\u00f3n permanente de nivel empresarial que establece un enlace cifrado entre dos Virtual Private Clouds en diferentes proveedores.</p> <p>La implementaci\u00f3n t\u00e9cnica requiri\u00f3 varios componentes cr\u00edticos. Primero, en AWS desplegamos un Virtual Private Gateway, que act\u00faa como el punto de terminaci\u00f3n del t\u00fanel desde el lado de AWS. Este gateway se conecta a nuestra VPC donde reside el RDS MySQL. En Azure, implementamos un Virtual Network Gateway de tipo VPN, que cumple la funci\u00f3n equivalente del lado de Azure.</p> <p>La configuraci\u00f3n de seguridad es donde la complejidad se manifiesta. Utilizamos el protocolo IKEv2 para el intercambio de claves, con cifrado AES-256 para el tr\u00e1fico de datos y SHA-256 para la autenticaci\u00f3n de integridad. Implementamos Perfect Forward Secrecy mediante Diffie-Hellman grupo 14, lo que significa que incluso si una clave de sesi\u00f3n se compromete, las sesiones anteriores permanecen seguras.</p> <p>Pero hay un detalle arquitect\u00f3nico cr\u00edtico: configuramos el t\u00fanel en modo activo-pasivo con dos t\u00faneles redundantes. \u00bfPor qu\u00e9 dos? Porque los servicios cloud pueden reiniciar o hacer mantenimiento en el endpoint del t\u00fanel sin previo aviso. Con dos t\u00faneles, si uno cae, el otro mantiene la conectividad sin interrupci\u00f3n en la replicaci\u00f3n de datos.</p>"},{"location":"guion-disertacion-dr/#replicacion-mysql-el-corazon-del-sistema","title":"Replicaci\u00f3n MySQL: El Coraz\u00f3n del Sistema","text":"<p>Ahora, la replicaci\u00f3n de base de datos es donde todo cobra vida. Implementamos MySQL 8.0 con replicaci\u00f3n binlog as\u00edncrona en formato ROW. Perm\u00edtanme explicar por qu\u00e9 cada una de estas decisiones t\u00e9cnicas es importante.</p> <p>El binlog o binary log es el mecanismo nativo de MySQL para capturar todos los cambios que ocurren en la base de datos. Cada INSERT, UPDATE, DELETE queda registrado en este log de manera secuencial. Pero hay diferentes formatos de binlog. Elegimos el formato ROW porque captura exactamente qu\u00e9 filas fueron modificadas y con qu\u00e9 valores. Esto es superior al formato STATEMENT, que solo registra el SQL ejecutado, porque el formato ROW garantiza consistencia incluso cuando hay funciones no determin\u00edsticas o diferencias de configuraci\u00f3n entre servidores.</p> <p>La replicaci\u00f3n funciona con una arquitectura maestro-esclavo. El servidor en AWS es el maestro con server-id 1, configurado con log_bin habilitado para generar el binlog. El servidor en Azure es la r\u00e9plica con server-id 2, configurado con relay_log para recibir y aplicar los cambios.</p> <p>Aqu\u00ed est\u00e1 lo fascinante del proceso t\u00e9cnico: en AWS configuramos un usuario espec\u00edfico de replicaci\u00f3n con privilegios REPLICATION SLAVE. Este usuario se conecta desde Azure a trav\u00e9s del t\u00fanel VPN cifrado. La r\u00e9plica de Azure mantiene dos threads cr\u00edticos: el IO thread que lee los eventos del binlog del maestro y los escribe en el relay log local, y el SQL thread que lee del relay log y ejecuta las transacciones en la base de datos local.</p> <p>El lag de replicaci\u00f3n, ese delta de tiempo entre cuando ocurre un cambio en AWS y cuando se aplica en Azure, es t\u00edpicamente menor a 1 segundo. Esto lo logramos mediante varios factores: el ancho de banda dedicado del t\u00fanel VPN, la baja latencia entre regiones de AWS y Azure en la costa este, y la configuraci\u00f3n de semi-sync replication en operaciones cr\u00edticas.</p> <p>Pero hay un aspecto operacional importante: durante la operaci\u00f3n normal, la base de datos de Azure est\u00e1 en modo read-only para prevenir cualquier escritura accidental que romper\u00eda la replicaci\u00f3n. Sin embargo, y esto es crucial para el failover, Azure MySQL Flexible Server no est\u00e1 realmente en modo read-only estricto. Puede convertirse en maestro simplemente deteniendo la replicaci\u00f3n, sin necesidad de cambios de configuraci\u00f3n adicionales.</p>"},{"location":"guion-disertacion-dr/#parte-2-deteccion-de-caidas-y-activacion-de-alertas-3-4-minutos","title":"Parte 2: Detecci\u00f3n de Ca\u00eddas y Activaci\u00f3n de Alertas (3-4 minutos)","text":""},{"location":"guion-disertacion-dr/#monitoreo-multi-capa","title":"Monitoreo Multi-Capa","text":"<p>La detecci\u00f3n temprana de fallos es fundamental para cumplir nuestro objetivo de RTO de 20 minutos. Implementamos un sistema de monitoreo en tres capas que opera bajo el principio de \"defense in depth\".</p> <p>La primera capa es el health check del Application Load Balancer de AWS. Cada 30 segundos, el ALB env\u00eda una petici\u00f3n HTTP al endpoint de salud de Gitea. Si tres intentos consecutivos fallan, el ALB marca el target como unhealthy. Pero aqu\u00ed est\u00e1 el problema: si falla toda la regi\u00f3n de AWS, el ALB mismo est\u00e1 ca\u00eddo, por lo que no puede alertarnos.</p> <p>La segunda capa es CloudWatch con m\u00e9tricas sint\u00e9ticas. Tenemos un Lambda function que se ejecuta cada minuto desde una regi\u00f3n diferente de AWS, intentando acceder al servicio. Esta Lambda est\u00e1 en us-west-2, geogr\u00e1ficamente separada de nuestra producci\u00f3n en us-east-1. Si detecta fallo, CloudWatch Alarm se dispara inmediatamente.</p> <p>La tercera capa, y quiz\u00e1s la m\u00e1s cr\u00edtica, es el monitoreo externo mediante UptimeRobot o similar. Este servicio SaaS monitorea desde m\u00faltiples ubicaciones geogr\u00e1ficas globales, completamente fuera de AWS. Es nuestra \u00faltima l\u00ednea de defensa para detectar una ca\u00edda regional completa.</p>"},{"location":"guion-disertacion-dr/#cascada-de-notificaciones","title":"Cascada de Notificaciones","text":"<p>Cuando se detecta una ca\u00edda potencial, se activa una cascada de notificaciones dise\u00f1ada para escalar apropiadamente. El primer nivel son notificaciones automatizadas por Slack al canal de incident-response. Estas notificaciones incluyen el timestamp exacto, el tipo de fallo detectado, y enlaces directos a los dashboards relevantes.</p> <p>Simult\u00e1neamente, se env\u00edan emails al equipo de guardia. Pero no solo un email gen\u00e9rico. El sistema env\u00eda un an\u00e1lisis preliminar: si solo el ALB health check fall\u00f3 pero CloudWatch desde otra regi\u00f3n responde, probablemente es un problema de aplicaci\u00f3n, no de regi\u00f3n. Si ambos fallan, es probable un problema de regi\u00f3n.</p> <p>El tercer nivel, si no hay respuesta humana en 5 minutos, es una llamada telef\u00f3nica automatizada. Esto puede parecer antiguo, pero en el caos de un incidente mayor donde m\u00faltiples sistemas pueden estar alertando, una llamada telef\u00f3nica corta el ruido.</p>"},{"location":"guion-disertacion-dr/#analisis-y-decision","title":"An\u00e1lisis y Decisi\u00f3n","text":"<p>Lo crucial aqu\u00ed es entender que no todo fallo amerita un failover a Azure. El failover es una operaci\u00f3n costosa y compleja que cambia fundamentalmente d\u00f3nde est\u00e1 nuestra fuente de verdad de datos. Por eso, el equipo de guardia debe ejecutar un an\u00e1lisis r\u00e1pido de 2 minutos para confirmar:</p> <p>\u00bfEs realmente una ca\u00edda de regi\u00f3n o solo un problema de aplicaci\u00f3n? Verificamos AWS Service Health Dashboard. Si AWS reporta problemas regionales en us-east-1, especialmente en EC2 o RDS, eso confirma la hip\u00f3tesis.</p> <p>\u00bfEst\u00e1 Azure funcionando correctamente? Verificamos que la r\u00e9plica de MySQL en Azure est\u00e1 respondiendo y que su replication lag es normal. No tiene sentido hacer failover a un sitio que tambi\u00e9n tiene problemas.</p> <p>\u00bfCu\u00e1l es el impacto en negocio? Si es 3 AM y hay cero usuarios conectados, podr\u00edamos esperar 30 minutos para ver si AWS se recupera. Si es medio d\u00eda con 500 desarrolladores intentando hacer push de c\u00f3digo, el failover es inmediato.</p>"},{"location":"guion-disertacion-dr/#parte-3-ejecucion-del-recovery-5-7-minutos","title":"Parte 3: Ejecuci\u00f3n del Recovery (5-7 minutos)","text":""},{"location":"guion-disertacion-dr/#fase-de-deployment-jenkins-como-orquestador","title":"Fase de Deployment: Jenkins como Orquestador","text":"<p>Una vez tomada la decisi\u00f3n de hacer failover, el proceso de recovery se ejecuta mediante Jenkins, nuestra plataforma de CI/CD que act\u00faa como orquestador central. Este detalle es fundamental: no ejecutamos scripts manualmente. Todo est\u00e1 codificado en un Jenkinsfile que garantiza consistencia y auditabilidad.</p> <p>El operador de guardia accede al Jenkins master, navega al pipeline llamado \"Azure-Gitea-Deployment\" y lo dispara con par\u00e1metros espec\u00edficos. Los par\u00e1metros son cr\u00edticos aqu\u00ed. Configuramos DEPLOYMENT_MODE en FAILOVER, no FULL_STACK. Esta distinci\u00f3n le dice a Jenkins que la base de datos ya existe y no debe intentar crearla.</p> <p>Establecemos PLAN_TERRAFORM en true, APPLY_TERRAFORM en true, y DEPLOY_ANSIBLE en true. Esta combinaci\u00f3n significa: primero verifica qu\u00e9 va a crear Terraform, luego cr\u00e9alo, y finalmente configura la aplicaci\u00f3n con Ansible.</p>"},{"location":"guion-disertacion-dr/#terraform-infraestructura-como-codigo","title":"Terraform: Infraestructura como C\u00f3digo","text":"<p>Cuando Jenkins ejecuta Terraform, est\u00e1 materializando infraestructura descrita como c\u00f3digo en archivos HCL. En aproximadamente 7 a 10 minutos, Terraform crea varios recursos en Azure:</p> <p>Primero, una m\u00e1quina virtual Standard_B2s con 2 vCPUs y 4 GB de RAM, suficiente para correr Gitea con carga moderada. Esta VM se despliega en la subnet privada donde ya existe nuestra base de datos MySQL.</p> <p>Segundo, un Azure Load Balancer de tipo Standard, que ser\u00e1 el nuevo punto de entrada p\u00fablico para los usuarios. El load balancer recibe una IP p\u00fablica est\u00e1tica que eventualmente reemplazar\u00e1 el DNS del servicio.</p> <p>Tercero, interfaces de red, security groups configurados para permitir tr\u00e1fico SSH desde rangos espec\u00edficos y tr\u00e1fico HTTP/HTTPS desde internet, y discos managed con cifrado habilitado por defecto.</p> <p>Lo elegante de Terraform aqu\u00ed es que todo es idempotente. Si el pipeline falla a mitad de camino y necesitamos re-ejecutarlo, Terraform entiende qu\u00e9 recursos ya existen y solo crea lo faltante. Esto es crucial en un escenario de alta presi\u00f3n.</p> <p>Al finalizar, Terraform genera outputs: la IP privada de la VM, la IP p\u00fablica del load balancer, y otros datos que necesitamos para la siguiente fase.</p>"},{"location":"guion-disertacion-dr/#ansible-configuracion-automatizada","title":"Ansible: Configuraci\u00f3n Automatizada","text":"<p>Con la infraestructura creada, Jenkins autom\u00e1ticamente procede a la fase de configuraci\u00f3n con Ansible. Este es un momento cr\u00edtico: tenemos m\u00e1quinas virtuales vac\u00edas que necesitan convertirse en servidores funcionales de Gitea en menos de 5 minutos.</p> <p>Jenkins toma los outputs de Terraform y genera din\u00e1micamente un archivo de inventario de Ansible. Este inventario especifica las IPs de las m\u00e1quinas target y las credenciales SSH necesarias. Aqu\u00ed encontramos un desaf\u00edo t\u00e9cnico interesante: la VM de Gitea est\u00e1 en subnet privada sin IP p\u00fablica directa. Ansible necesita conectarse a trav\u00e9s de un jump host o bastion.</p> <p>La soluci\u00f3n que implementamos es ProxyJump en la configuraci\u00f3n SSH de Ansible. Le decimos a Ansible: para conectarte a la VM de Gitea en 10.1.2.x, primero SSH al bastion en la IP p\u00fablica, y desde ah\u00ed salta a la VM privada. Esto se logra con un simple par\u00e1metro ansible_ssh_common_args.</p> <p>El playbook de Ansible ejecuta varias tareas secuenciales. Primero, instala dependencias del sistema: git, build-essential, y otras herramientas. Luego descarga el binario precompilado de Gitea versi\u00f3n 1.21.5 desde el repositorio oficial de GitHub.</p> <p>La configuraci\u00f3n cr\u00edtica est\u00e1 en el archivo app.ini de Gitea. Ansible usa un template Jinja2 que inserta variables espec\u00edficas del ambiente de Azure. La secci\u00f3n de base de datos es particularmente importante: especificamos el hostname del MySQL de Azure, el puerto 3306, y las credenciales. Utilizamos Ansible Vault para cifrar estas credenciales en el repositorio Git.</p> <p>Ansible tambi\u00e9n configura Gitea como un systemd service, asegurando que se inicie autom\u00e1ticamente si la VM se reinicia. Habilita el servicio, lo inicia, y luego ejecuta una verificaci\u00f3n de salud simple: intenta hacer un HTTP GET al localhost:3000 para confirmar que Gitea responde.</p>"},{"location":"guion-disertacion-dr/#promocion-de-base-de-datos-el-momento-critico","title":"Promoci\u00f3n de Base de Datos: El Momento Cr\u00edtico","text":"<p>Con la aplicaci\u00f3n desplegada, llegamos al paso m\u00e1s delicado del failover: promover la r\u00e9plica de MySQL a maestro. Este es un momento de no-retorno. Una vez que hacemos esto, Azure MySQL deja de ser r\u00e9plica y se convierte en la fuente autoritativa de datos.</p> <p>El operador se conecta v\u00eda SSH a la VM de Gitea o utiliza un cliente MySQL directo para conectarse al MySQL Flexible Server de Azure. Ejecuta dos comandos SQL simples pero poderosos: STOP REPLICA para detener los threads de replicaci\u00f3n, y RESET REPLICA ALL para eliminar completamente la configuraci\u00f3n de replicaci\u00f3n y las coordenadas del binlog del maestro antiguo.</p> <p>Es importante entender que Azure MySQL Flexible Server, a diferencia de implementaciones tradicionales de r\u00e9plicas, no est\u00e1 en modo read_only estricto. Esto significa que no necesitamos ejecutar comandos adicionales para hacerlo escribible. Simplemente dejamos de replicar y autom\u00e1ticamente puede aceptar escrituras.</p> <p>Verificamos con SHOW MASTER STATUS que la base de datos ahora est\u00e1 generando su propio binlog. Esto es importante porque si alg\u00fan d\u00eda queremos hacer failback a AWS, necesitamos este binlog para sincronizar datos en direcci\u00f3n inversa.</p>"},{"location":"guion-disertacion-dr/#validacion-y-activacion","title":"Validaci\u00f3n y Activaci\u00f3n","text":"<p>Los \u00faltimos minutos del proceso son de validaci\u00f3n exhaustiva antes de declarar el recovery exitoso. Primero, verificamos que Gitea est\u00e1 accesible a trav\u00e9s de la IP del load balancer de Azure. Hacemos un git clone de un repositorio de prueba para confirmar que las operaciones de lectura funcionan.</p> <p>Luego, ejecutamos una operaci\u00f3n de escritura: creamos un nuevo repositorio de prueba o hacemos un push de un commit. Esto confirma que la base de datos est\u00e1 aceptando escrituras y que la integraci\u00f3n entre Gitea y MySQL funciona correctamente.</p> <p>Finalmente, actualizamos el DNS. Si estamos usando AWS Route 53 o cualquier otro proveedor de DNS, cambiamos el registro A de gitea.company.com para que apunte a la nueva IP p\u00fablica del load balancer de Azure en lugar del ALB de AWS. Este cambio de DNS puede tomar de 5 a 60 minutos en propagarse globalmente, dependiendo de nuestros TTL configurados.</p> <p>Durante esta ventana de propagaci\u00f3n de DNS, tendremos usuarios llegando tanto al sitio viejo (AWS ca\u00eddo) como al nuevo (Azure funcionando). Los que lleguen a AWS ver\u00e1n errores. Los que lleguen a Azure ver\u00e1n el servicio funcionando. Es un per\u00edodo inc\u00f3modo pero inevitable.</p>"},{"location":"guion-disertacion-dr/#conclusion-2-minutos","title":"Conclusi\u00f3n (2 minutos)","text":"<p>Lo que hemos construido aqu\u00ed es m\u00e1s que un simple sistema de backup. Es una arquitectura completa de disaster recovery que balancea tres objetivos cr\u00edticos: disponibilidad, costo y complejidad operacional.</p> <p>Nuestro RTO de 20 minutos est\u00e1 compuesto de 6 minutos de detecci\u00f3n, 2 minutos de decisi\u00f3n, 15 minutos de deployment automatizado, y unos minutos finales de validaci\u00f3n. Este timeline es realista y alcanzable porque hemos automatizado cada paso que es automatizable y hemos practicado los pasos manuales hasta que son segunda naturaleza.</p> <p>Nuestro RPO de menos de 1 segundo es posible gracias a la replicaci\u00f3n continua de MySQL a trav\u00e9s del t\u00fanel VPN cifrado. En el peor caso de un failover, perdemos solo las transacciones que estaban en vuelo en el momento exacto de la ca\u00edda.</p> <p>El costo de mantener esta capacidad es de aproximadamente 125 d\u00f3lares mensuales: 100 d\u00f3lares en AWS para la operaci\u00f3n normal, y 25 d\u00f3lares en Azure solo para la r\u00e9plica de base de datos. Cuando ocurre un failover, el costo de Azure sube a 100 d\u00f3lares por los recursos adicionales, pero AWS baja a cero, manteniendo el costo total controlado.</p> <p>La lecci\u00f3n t\u00e9cnica m\u00e1s importante que quiero dejar es esta: el disaster recovery efectivo no es solo sobre tener backups. Es sobre tener un proceso completo, probado y automatizado para convertir esos backups en sistemas funcionando bajo presi\u00f3n. Es sobre tomar decisiones arquitect\u00f3nicas deliberadas como la r\u00e9plica cost-optimized, implementar capas de monitoreo redundantes, y sobre todo, documentar y practicar el proceso hasta que el equipo pueda ejecutarlo casi instintivamente en medio de una crisis.</p> <p>Gracias por su atenci\u00f3n. Estoy disponible para preguntas.</p> <p>Este gui\u00f3n est\u00e1 dise\u00f1ado para una presentaci\u00f3n de 20-25 minutos. Ajuste el ritmo seg\u00fan el tiempo disponible y el nivel t\u00e9cnico de la audiencia.</p>"}]}